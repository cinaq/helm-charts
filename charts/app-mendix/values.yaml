# replicaCount: 2 | 1 leader, 1 slave
replicaCount: 1

image:
  repository: "cinaq/hackme"
  tag: "latest"
  pullPolicy: "Always"
imagePullSecrets:
  - name: dockerconfigjson

podSecurityContext: {}
  # runAsUser: 1000
  # runAsGroup: 1000
  # fsGroup: 1000

licenseId:
licenseKey:

env: []
  # - name: SCHEDULED_EVENTS
  #   value: ALL
  # - name: MX_Module_Constant
  #   value: test
  # - name: MX_App_EnvironmentName
  #   value: acceptance
  # - name: TZ
  #   value: Europe/Amsterdam
  # - name: PORT
  #   value: 8080
  # - name: MXRUNTIME_ApplicationRootUrl
  #   value: "https://mx-app.example.com/"
  # - name: MXRUNTIME_DatabaseHost
  #   value: "mendix-postgres:5432"
  # - name: MXRUNTIME_DatabaseType
  #   value: "PostgreSQL"
  # - name: MXRUNTIME_DatabaseName
  #   value: "mendix"
  # - name: S3_BUCKET_NAME
  #   value: "test-mx-app"
  # - name: S3_ENDPOINT
  #   value: "http://minio:9000"
  # - name: ADMIN_PASSWORD
  #   value: "Hello0123!!"
  # - name: MXRUNTIME_DatabaseUserName
  #   value: "postgres"
  # - name: MXRUNTIME_DatabasePassword
  #   value: "postgres12!"
  # - name: S3_ACCESS_KEY_ID
  #   value: "keyid"
  # - name: S3_SECRET_ACCESS_KEY
  #   value: "accesskey"

# Secret name with mendix application runtime variables. Will be loaded as pod environment variables
#  Example data
#  data:
#   ADMIN_PASSWORD: SGVsbG8wMTIzY2xlYXIK (base64)
secretName: ""

nodeSelector: {}

tolerations: []

affinity: {}

resources: {}
  # limits:
  #   cpu: 1
  #   memory: 1Gi
  # requests:
  #   cpu: 0.5
  #   memory: 512Mi

annotations: {}

service:
  type: ClusterIP
  externalPort: 80
  internalPort: 8080

ingress:
  enabled: true
  ingressClassName: nginx
  domain: app.example.com
  annotations: {}
  addHosts: false
  hosts: []
  tls:
    enabled: false
  # Secrets must be manually created in the namespace.
    secretName: secret-tls

# Enable to create openshift route
route:
  enabled: false
  host: app.example.com
  annotations: {}
  tls:
    enabled: false

networkPolicy:
  # Enable network policy for namespace isolation (SaaS mode)
  enabled: false
  
  # Ingress configuration
  ingress:
    enabled: true
    # Namespace selector for ingress controller
    namespaceSelector:
      name: ingress-nginx
    # Pod selector for ingress controller (optional)
    podSelector: {}
      # app.kubernetes.io/name: ingress-nginx
  
  # Egress configuration
  egress:
    # PostgreSQL database
    postgresql:
      enabled: true
      port: 5432
      # Leave empty for same namespace, or specify:
      namespaceSelector: {}
        # name: lowops-data
      podSelector: {}
        # cnpg.io/cluster: my-cluster
    
    # S3 Gateway (Minio)
    s3Gateway:
      enabled: true
      port: 9000
      namespaceSelector:
        name: lowops-data
      podSelector:
        app.kubernetes.io/component: s3-gateway-apps
    
    # Tempo/OTEL tracing
    tempo:
      enabled: true
      grpcPort: 4317
      httpPort: 4318
      namespaceSelector:
        name: lowops-monitoring
      podSelector:
        app.kubernetes.io/name: opentelemetry-collector
    
    # External connectivity (webhooks, APIs, etc.)
    external:
      enabled: true
      ports:
        - protocol: TCP
          port: 80
        - protocol: TCP
          port: 443
      # Optionally exclude internal cluster CIDRs
      exceptCIDRs: []
        # - 10.0.0.0/8
        # - 172.16.0.0/12
        # - 192.168.0.0/16
    
    # Custom egress rules (advanced use cases)
    custom: []
      # - to:
      #   - podSelector:
      #       matchLabels:
      #         app: redis
      #   ports:
      #   - protocol: TCP
      #     port: 6379
autoscale:
  enabled: false
  minSlaveReplicas: 1
  maxSlaveReplicas: 3
  targetCPUUtilizationPercentage: 70

# available from kubernetes 1.20+
# max 3 hours
startupProbe:
  failureThreshold: 1080
  periodSeconds: 10

# max 5 minutes
readinessProbe:
  periodSeconds: 10
  failureThreshold: 30

# max 3 minutes
livenessProbe:
  periodSeconds: 10
  failureThreshold: 18

lifecycle:
  prestop:
    enabled: false
    command: /opt/eap/bin/stop.sh

metrics:
  enabled: true
  runtimeLoginMetricsEnabled: true
  # example: http://loki-stack:3100/loki/api/v1/push
  trendsForwarderUrl: ""

persistence:
  enabled: false

  # if enabled, a pv, pvc resources will be created and mounted to statefulset
  nfsVolume:
    enabled: false
    name: mendix-nfs
    server: nfs.example.com
    path: /mnt/mendixdata
    storage: 10Gi
    subPath: "/app"

  extraVolumes: []
    # - name: extra-volume
    #   persistentVolumeClaim:
    #     claimName: precreated-pvc

  extraVolumeMounts: []
    # - name: extra-volume
    #   mountPath: /path/to/mount
    #   subPath: "/app"